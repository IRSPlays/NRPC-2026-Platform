"use strict";(()=>{var e={};e.id=218,e.ids=[218],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9491:e=>{e.exports=require("assert")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5158:e=>{e.exports=require("http2")},5687:e=>{e.exports=require("https")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},2781:e=>{e.exports=require("stream")},6224:e=>{e.exports=require("tty")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},8379:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>g,originalPathname:()=>y,patchFetch:()=>v,requestAsyncStorage:()=>q,routeModule:()=>h,serverHooks:()=>j,staticGenerationAsyncStorage:()=>k,staticGenerationBailout:()=>b});var s={};t.r(s),t.d(s,{POST:()=>m});var o=t(5419),a=t(9108),n=t(9678),i=t(8070),u=t(8428),p=t(7147),c=t.n(p),d=t(1017),l=t.n(d),x=t(8951),f=t.n(x);async function m(e){try{let{url:r,key:t,filename:s}=await e.json();if(!r||!t||!s)return i.Z.json({error:"Missing configuration"},{status:400});let o=[l().join(process.cwd(),"backups"),l().join(process.cwd(),"data","backups"),l().join(process.cwd(),"..","backups"),l().join(process.cwd(),"..","data","backups")],a=null;for(let e of o){let r=l().join(e,s);if(c().existsSync(r)){a=r;break}}if(!a)return i.Z.json({error:"Backup file not found on local drive"},{status:404});if(console.log(`Restoring ${s} to ${r}...`),s.endsWith(".zip")){let e=new(f());e.append("backup",c().createReadStream(a));let s=await u.Z.post(`${r}/api/admin/system/restore`,e,{headers:{"x-backup-key":t,...e.getHeaders()},maxBodyLength:1/0,maxContentLength:1/0});return i.Z.json({success:!0,data:s.data})}if(!s.endsWith(".json"))return i.Z.json({error:"Unsupported file format"},{status:400});{let e=JSON.parse(c().readFileSync(a,"utf8")),s=await u.Z.post(`${r}/api/admin/system/restore-json`,{backupData:e},{headers:{"x-backup-key":t}});return i.Z.json({success:!0,data:s.data})}}catch(e){return console.error("Restore failed:",e.response?.data||e.message),i.Z.json({error:e.response?.data?.error||e.message},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/restore/route",pathname:"/api/restore",filename:"route",bundlePath:"app/api/restore/route"},resolvedPagePath:"C:\\Users\\Haziq\\Documents\\NRPC Platform\\local-backup-tool\\app\\api\\restore\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:q,staticGenerationAsyncStorage:k,serverHooks:j,headerHooks:g,staticGenerationBailout:b}=h,y="/api/restore/route";function v(){return(0,n.patchFetch)({serverHooks:j,staticGenerationAsyncStorage:k})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,206,428],()=>t(8379));module.exports=s})();